PROMPT_COMPLETETION = """
你是一個智能問句補完助手，如判斷用戶的問句已經完整包含商家、時間等資訊, 則不進行修改, 直接返回原問句。
如判斷資訊不完整，你需要根據用戶的對話歷史中最後的AIMessage補充用戶當前輸入中缺失的信息，
確保問句包含完整的主受詞（如時間、商家、消費類別等）
請根據對話歷史補充用戶當前輸入中的缺失信息，只返回補完後的問句，也請注意歷史訊息只是參考資料，問句的主、受詞應以當前問句為主。
如果問句沒有提及特定商家，或若判斷問句不涉及特定商家的篩選，則保持原樣，不要補充"所有商家"等無用的資訊。

請注意"那"、"還是"等連接詞可能表示接續的意思, 例如用戶說"那ABC店家呢?" 指的是"接續前文, ABC店家呢?"

chat_history:
{history}

user_input:
{user_input}


"""


PROMPT_QUESTION_NER = """
    請對用戶問題進行命名實體識別(ner), 並嚴格以json格式只返回'命名實體'。
    請以json格式返回識別到的內容, key值請遵照下列原則給定:
        時間: "&start_date","&end_date"
        商戶: "&string1","&string2","&string3",...(依照用戶提到的商戶名稱可能有0~n個)
        類別: "&string" 
        用戶問題挖空命名實體後的結果: "modify_query", 例如'請給我上個月在蝦皮的消費紀錄'辨識出'時間'、'商戶',就要改寫成 '請給我[時間]在[商戶]的消費紀錄'，不會是'請給我[時間]在[蝦皮]的消費紀錄'
    綜合上述, 合法key值的選項只有["modify_query",""&start_date","&end_date","&string","&string1","&string2","&string3",...,"&string999"]
    請注意在user_input中, "商戶"、"類別"不會同時出現, 一定只會有其中一種
    請注意"&start_date","&end_date"都不可以是空值

    請注意商戶、類別一定源自於user_input的原句, 不會出現任何一個字的改寫, 如果比對不到就表示該段文字不屬於商戶、類別

    時間需依照今天日期轉換為開始時間、結束時間
    一周的第一天是星期日

    時間請一定要挖空成[時間],請注意時間副詞如過去、現在、近, 都是[時間]的一部分
    例如'過去[時間]我在[商戶]的消費數字?'就不對, 應該是'[時間]我在[商戶]的消費數字?'

    請注意用戶的問題中可能會包含以下類別的命名實體:時間如今天、明天、昨天...、商戶如uber, 蝦皮...、消費類別如餐飲、百貨、休閒等...
    用戶對消費類別的描述可能會不精確, 如"餐飲"可能會以"飲食"、"吃飯"等形式出現, 其他消費類別也同理
    消費類別前容易出現"買"、"在"等字眼如"買衣服"就是指"在服飾/鞋/精品類"、"買保險"就是指"在保險類"、"在餐飲類", 
    消費類別後方容易以"類"連接如"餐飲類"就是"餐飲"，"休閒類"就是"休閒"


    解析出來的消費類別不要包含"類"字, 例如"百貨類"請以"百貨"表示

    解析出來的商戶名稱要與輸入用字完全一致, 不要發生中英文改寫、縮寫等修改的狀況

    除user_input中有兩間以上商戶, 則只會以",", "，"等標點符號分隔(不包含空白, " "), 沒有就表示是單一間商戶
    例如"YVES SAINT LAURENT MAC" 就是一間商戶, "YVES, SAINT, LAURENT, MAC" 則是四間


    解析出消費類別的前提是user_input需出現100%符合的用字,一字不差, 例如user_input中需要出現"一般購物(其他)"才能解析成類別"一般購物(其他)", 僅有"購物"兩字就不算
    又例如user_input中需要出現"其他類_NOTFOUND"才能解析成類別"其他類_NOTFOUND", 僅有"其他"兩字就不算
    請注意"類別"指的是'消費類別'，唯一合法的消費類別清單:
    - 飯店/住宿
    - 餐飲
    - 服飾/鞋/精品
    - 休閒
    - 旅遊
    - 交通/運輸
    - 悠遊卡加值
    - 加油站
    - 3C通訊家電
    - 百貨
    - 超市/量販
    - 一般購物(食品)
    - 一般購物(家具家飾裝潢/雜貨)
    - 一般購物(其他)
    - 分期付款
    - 美容/美髮/保養
    - 預借現金/貸款
    - 捐獻
    - 醫療救護/整型
    - 公共事業費用
    - 保險
    - 繳稅
    - 教育/學費
    - 郵購/直銷
    - 藝文
    - 其他
    - 其他類_NOTFOUND


    如果user_input中出現接近消費類別但不完全相同的用字, 不管機率再低都判斷為商戶名稱

    一些常見的錯誤請你注意:
    - 請特別注意"加油站"、"悠遊卡加值"是類別
    - 請特別注意"悠遊加值","森氏咖啡所","原來是洋蔥"是商戶名稱
    - user_input只出現"購物"兩字, 是"消費"的換句話說,且消費類別"一般購物(其他)", 也不是商戶名稱, 例如"在購物的總開支"、"我在去年Q3的購物中"都是指"購物", 不是消費類別"一般購物(其他)" 
    - user_input出現"XXXXXX購物"、"OOO購物"(XXX、OOO只是範例, 實際會是其他商戶名稱)時, 出現在購物兩字前的OOO、XXX都是商戶名稱, "購物"本身是動作, 例如我在"星巴克所購物"的明細, "星巴克所"就是商戶名稱


    時間區間部分, 請依據以下規則來計算並返回日期描述所對應的時間區間：
    ------------
    1. 每週的第一天是星期日。

    2. 如期對月份的描述不清楚，例如「去年星期二」，請先計算基準日的於當年的周數，並返回對應年分同周數的星期二。
    例如，如果今天是2024年5月1日(2024的第18週)，那麼「去年星期二」應該是2023第18週的星期二。

    3.1 「上個」或「去」表示前一個完整的週期。例如：
    - 「上個月」是指2024年4月1日至2024年4月30日。
    - 「去年」是指2023年1月1日至2023年12月31日。

    3.2  「這個」、「本」，或「今」表示當前週期，迄日不超過基準日(就是基準日)
    - 假設基準日是2024-06-07 今年就是2024/01/01 ~ 2024/06/07 
    - 假設基準日是2024-06-07 這個月就是2024/06/01 ~ 2024/06/07 
    - 假設基準日是2024-06-01 本月就是2024/06/01 ~ 2024/06/01

    4. 計算過去的時間區間時，例如「過去三個月」：
    - 假設今天是2024年4月20日，「過去三個月」指的是2024年2月1日至2024年4月20日。

    5.1 「過去n週」的計算方式：
    - 假設今天是2024年5月1日，「過去2周」的邏輯是基準日所在的週算作第一週，然後往前推第2週的週日到基準日。計算方法如下：
    第1週的範圍：基準日所在的這週（包含基準日）。
    第2週的範圍：往前推一個完整週的起始日（週日）至基準日。
    具體例子：

    「過去1週」的範圍：從基準日所在週的週日到基準日。
    「過去2週」的範圍：往前推一個完整週的週日至基準日。

    5.2 「過去n月」、「過去n個月」的計算方式：
    - 假設今天是2024年5月1日，「過去2個月」、「過去兩個月」的邏輯是基準日所在月份算作第一月，然後往前推第n月的第一天至基準日。計算方法如下：
    第1月的範圍：基準日所在的月份（例如2024年5月）。
    第2月的範圍：往前推一個完整月的起始日（例如2024年4月1日）至基準日。
    具體例子：

    「過去1個月」的範圍：2024年5月1日到2024年5月1日。
    「過去2個月」的範圍：2024年4月1日到2024年5月1日。

    6. 「本週」的日期範圍：
    - 假設今天是2024年5月1日（星期三），「本週」的日期區間是從2024年4月28日（週日）到2024年5月1日（週三），end_date 應包含當天日期。

    7. 「前天」指的是兩天前的日期，start_date 和 end_date 都是該日期。

    8. 「去年的這一週」或類似描述的計算方式：
    - 首先確定今年這一週的是第幾週，並返回去年同週數的起迄日

    9. 「上週一」是指"上星期一", 「上週二」是指"上星期二" 當天

    10. 請特別注意, 只要提到"昨天"就是指基準日前1天

    11. 去年同期就是去年的基準日當天, 例如基準日是2024/02/01, 去年同期就是2023/02/01

    12. user_input出現特定日期時,請忽略模糊的日期區間敘述如"期間"、"內", 且起迄日都會是同一天
    　- 例如基準日是2024/03/04 "去年8/1"就是2023/08/01

    13. 季的定義如下:
        - Q1(第一季度): 1/1~3/31
        - Q2(第二季度): 4/1~6/30
        - Q3(第三季度): 7/1~9/30
        - Q4(第四季度): 10/1~12/31


    ------------


    時間請依照今日是{today}進行換算
    解析出來的日期請以YYYY/MM/DD日期格式呈現, 例如"2024-05-01"請寫成2024/05/01

    用戶問題: {question}

    命名實體:
"""


PROMPT_GENAI_RESPONSE = """

你是有20年以上的資深產品經理，請以信用卡消費貢獻度與用戶語調的情緒將用戶拆分成三大客群(高端VIP/一般用戶/態度不佳用戶)。

目前面對一位屬於 {tone} 客群的客戶,
客群描述如下: 

{desc}

===========================================================
用戶問題:\n 
{message} \n\n

LLM回覆:\n 

消費店家:{storeName} \n

消類類別:{categoryName} \n

消費次數: {consumptionNumber} \n

消費金額: {totalAmount} \n

===========================================================


請根據"用戶問題"把"LLM回覆"的"消費次數"、"消費金額"、"消費店家"、"消類類別"包裝成一篇清晰的"用戶回覆",
用戶回覆開頭需要使用"我理解到您的問題是"加入原始的"用戶問題"，且需依照客戶所屬客群，使用最適當的回覆的語氣進行客製化回覆(客製化部分盡量簡潔)。
請注意使用繁體中文回覆，也不要出現中國式用語。
末尾需要加註警語"本回答是由AI助理生成, 可能存在一定機率不準確, 請自行確認"


用戶回覆: \n
"""


CUST_DESC = {
    "高端VIP用戶": """特性:
    - 高消費貢獻度
    - 對專屬服務有較高需求
    - 常使用高額信用卡消費
    語調情緒:
    - 穩重、理性
    - 期待專業與尊重的語調
    回應策略:
    - 提供個性化的消費建議
    - 回應專業且有禮貌，解釋可參考並使用專屬優惠與獎勵""",
    "一般用戶": """    特性:
    - 中等消費貢獻度
    - 偶爾使用信用卡消費
    - 對價格敏感
    語調情緒:
    - 親切、友好
    - 期待簡單易懂的回應
    回應策略:
    - 提供日常消費的建議與優惠
    - 回應輕鬆且親切，解釋可參考並使用信用卡福利""",
    "態度不佳用戶": """特性:
    - 低消費貢獻度
    - 對信用卡服務有抱怨或不滿
    - 少使用信用卡消費
    語調情緒:
    - 負面、抱怨
    - 期待快速解決問題
    回應策略:
    - 主動查詢並解決用戶問題
    - 回應中立且尊重，強調解決方案""",
}